{"version":3,"sources":["lighting/Lighting.js","terrain/rock.jpg","terrain/DisplacementMap.png","functions/Math.js","terrain/Water.js","terrain/Terrain.js","player/PlayerMovement.js","player/PlayerCamera.js","player/ball.jpg","player/Player.js","player/PlayerControls.js","App.js","index.js"],"names":["Lighting","props","Sky","distance","sunPosition","inclination","azimuth","position","shadow-camera-left","shadow-camera-bottom","shadow-camera-right","shadow-camera-top","shadow-camera-near","shadow-camera-far","castShadow","perlin","rand_vect","theta","Math","random","PI","x","cos","y","sin","dot_prod_grid","vx","vy","g_vect","d_vect","this","gradients","smootherstep","interp","a","b","seed","memory","get","hasOwnProperty","xf","floor","yf","tl","tr","bl","br","xt","xb","v","Water","W","useControl","type","value","min","max","usePlane","rotation","args","ref","useFrame","current","receiveShadow","attach","side","THREE","metalness","color","transparent","opacity","Plane","canyons","wireframe","mapSize","vertices","amp","length","xShift","yShift","geometry","useRef","texture","useLoader","rocks","dM","rocksDisp","material","map","displacementMap","useEffect","mV","height","modifiedVertices","Terrain","PlayerMovement","forwardRef","STATS","api","C","forward","backward","left","right","jump","run","velocity","jumpCoolDown","direction","frontVector","sideVector","camEuler","calculateVelocity","set","FinalSpeed","speed","pan_speed","run_speed","subVectors","normalize","multiplyScalar","applyEuler","camera","inertia","z","jump_height","subscribe","PlayerCamera","pos","player_height","moveCamera","PointerLockControls","Player","useSphere","mass","size","useThree","useState","movement","setMovement","keys","KeyW","KeyS","KeyA","KeyD","Space","ShiftLeft","moveFieldByKey","key","handleKeyDown","e","m","code","handleKeyUp","document","addEventListener","removeEventListener","usePlayerControls","ball","App","Provider","Canvas","shadowMap","gl","antialias","alpha","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.69f18f16.chunk.js","sourcesContent":["import React, { useRef } from 'react'\r\nimport * as THREE from 'three'\r\nimport { Sky } from '@react-three/drei'\r\n\r\nexport const Lighting = props => {\r\n  return (\r\n    <>\r\n      {/* <fog attach=\"fog\" args={['white', 0, 40]} /> */}\r\n      <Sky\r\n        distance={450000}\r\n        sunPosition={[150, 150, 150]}\r\n        inclination={0}\r\n        azimuth={0.25}\r\n      />\r\n      <ambientLight />\r\n      <directionalLight\r\n        position={[150, 150, 150]}\r\n        shadow-camera-left={-1000}\r\n        shadow-camera-bottom={-1000}\r\n        shadow-camera-right={1000}\r\n        shadow-camera-top={1000}\r\n        shadow-camera-near={0.1}\r\n        shadow-camera-far={1500}\r\n        castShadow\r\n      />\r\n    </>\r\n  )\r\n}\r\n","export default __webpack_public_path__ + \"static/media/rock.2a68dd7c.jpg\";","export default __webpack_public_path__ + \"static/media/DisplacementMap.876a1148.png\";","export const math = (function () {\r\n  return {\r\n    rand_range: function (a, b) {\r\n      return Math.random() * (b - a) + a\r\n    },\r\n\r\n    rand_normalish: function () {\r\n      const r = Math.random() + Math.random() + Math.random() + Math.random()\r\n      return (r / 4.0) * 2.0 - 1\r\n    },\r\n\r\n    rand_int: function (a, b) {\r\n      return Math.round(Math.random() * (b - a) + a)\r\n    },\r\n\r\n    lerp: function (x, a, b) {\r\n      return x * (b - a) + a\r\n    },\r\n\r\n    smoothstep: function (x, a, b) {\r\n      x = x * x * (3.0 - 2.0 * x)\r\n      return x * (b - a) + a\r\n    },\r\n\r\n    smootherstep: function (x, a, b) {\r\n      x = x * x * x * (x * (x * 6 - 15) + 10)\r\n      return x * (b - a) + a\r\n    },\r\n\r\n    clamp: function (x, a, b) {\r\n      return Math.min(Math.max(x, a), b)\r\n    },\r\n\r\n    sat: function (x) {\r\n      return Math.min(Math.max(x, 0.0), 1.0)\r\n    },\r\n\r\n    in_range: (x, a, b) => {\r\n      return x >= a && x <= b\r\n    },\r\n  }\r\n})()\r\n\r\nexport let perlin = {\r\n  rand_vect: function () {\r\n    let theta = Math.random() * 2 * Math.PI\r\n    return { x: Math.cos(theta), y: Math.sin(theta) }\r\n  },\r\n  dot_prod_grid: function (x, y, vx, vy) {\r\n    let g_vect\r\n    let d_vect = { x: x - vx, y: y - vy }\r\n    if (this.gradients[[vx, vy]]) {\r\n      g_vect = this.gradients[[vx, vy]]\r\n    } else {\r\n      g_vect = this.rand_vect()\r\n      this.gradients[[vx, vy]] = g_vect\r\n    }\r\n    return d_vect.x * g_vect.x + d_vect.y * g_vect.y\r\n  },\r\n  smootherstep: function (x) {\r\n    return 6 * x ** 5 - 15 * x ** 4 + 10 * x ** 3\r\n  },\r\n  interp: function (x, a, b) {\r\n    return a + this.smootherstep(x) * (b - a)\r\n  },\r\n  seed: function () {\r\n    this.gradients = {}\r\n  },\r\n  memory: {},\r\n  get: function (x, y) {\r\n    if (this.memory.hasOwnProperty([x, y])) return this.memory[[x, y]]\r\n    let xf = Math.floor(x)\r\n    let yf = Math.floor(y)\r\n    //interpolate\r\n    let tl = this.dot_prod_grid(x, y, xf, yf)\r\n    let tr = this.dot_prod_grid(x, y, xf + 1, yf)\r\n    let bl = this.dot_prod_grid(x, y, xf, yf + 1)\r\n    let br = this.dot_prod_grid(x, y, xf + 1, yf + 1)\r\n    let xt = this.interp(x - xf, tl, tr)\r\n    let xb = this.interp(x - xf, bl, br)\r\n    let v = this.interp(y - yf, xt, xb)\r\n    this.memory[[x, y]] = v\r\n    return v\r\n  },\r\n}\r\nperlin.seed()\r\n","import * as THREE from 'three'\r\nimport React from 'react'\r\n\r\nimport { MeshWobbleMaterial} from '@react-three/drei'\r\n\r\nimport { useFrame } from 'react-three-fiber'\r\nimport { useControl } from 'react-three-gui'\r\nimport { usePlane } from 'use-cannon'\r\n\r\nexport function Water() {\r\n  const mapWidth = 1000,\r\n    mapLength = 1000\r\n  const vX = 64\r\n\r\n  const W = useControl('Water Level', {\r\n    type: 'number',\r\n    value: -0.5,\r\n    min: -5,\r\n    max: 5,\r\n  })\r\n\r\n  const [ref, api] = usePlane(() => ({\r\n    position: [0, W, 0],\r\n    rotation: [-Math.PI / 2, 0, 0],\r\n    args: [mapWidth, mapLength, vX, vX],\r\n  }))\r\n\r\n  useFrame(() => {\r\n    ref.current.position.y = W\r\n    // api.position.set([0, W, 0])\r\n  })\r\n\r\n  return (\r\n    <mesh ref={ref} receiveShadow>\r\n      <planeBufferGeometry\r\n        attach=\"geometry\"\r\n        args={[mapWidth, mapLength, vX, vX]}\r\n      />\r\n      <meshStandardMaterial\r\n        attach=\"material\"\r\n        side={THREE.DoubleSide}\r\n        metalness={2}\r\n        color='blue'\r\n        transparent\r\n        opacity={.2}\r\n      />\r\n    </mesh>\r\n  )\r\n}\r\n","import React, { useEffect, useRef } from 'react'\r\n\r\nimport * as THREE from 'three'\r\nimport { useLoader } from 'react-three-fiber'\r\nimport { useControl } from 'react-three-gui'\r\nimport { useConvexPolyhedron } from 'use-cannon'\r\n\r\nimport rocks from './rock.jpg'\r\nimport rocksDisp from './DisplacementMap.png'\r\nimport { perlin } from '../functions/Math'\r\nimport { Water } from './Water'\r\n\r\nfunction modifiedVertices(geometry, amp, length, canyons, xShift, yShift) {\r\n  return geometry.vertices.map(v => {\r\n    let height = amp * perlin.get(length * v.x + xShift, length * v.y + yShift)\r\n\r\n    if (canyons) {\r\n      height += Math.floor(height)\r\n    }\r\n    return new THREE.Vector3(v.x, v.y, height)\r\n  })\r\n}\r\n\r\nconst Plane = props => {\r\n  const canyons = useControl('Canyons', {\r\n    type: 'boolean',\r\n    value: false,\r\n  })\r\n  const wireframe = useControl('Wireframe', {\r\n    type: 'boolean',\r\n    value: false,\r\n  })\r\n  const mapSize = useControl('Map Size', {\r\n    type: 'number',\r\n    value: 100,\r\n    min: 10,\r\n    max: 1000,\r\n  })\r\n  const vertices = useControl('Vertices', {\r\n    type: 'number',\r\n    value: 200,\r\n    min: 10,\r\n    max: 1000,\r\n  })\r\n  const amp = useControl('Amplitude', {\r\n    type: 'number',\r\n    value: 30,\r\n    min: 0,\r\n    max: 50,\r\n  })\r\n  const length = useControl('Length', {\r\n    type: 'number',\r\n    value: 0.03,\r\n    min: 0,\r\n    max: 0.1,\r\n  })\r\n  const xShift = useControl('X-Shift', {\r\n    type: 'number',\r\n    value: 0,\r\n    min: -5,\r\n    max: 5,\r\n  })\r\n  const yShift = useControl('Y-Shift', {\r\n    type: 'number',\r\n    value: 0,\r\n    min: -5,\r\n    max: 5,\r\n  })\r\n\r\n  const geometry = useRef(\r\n    new THREE.PlaneGeometry(mapSize, mapSize, vertices, vertices)\r\n  )\r\n\r\n  const texture = useLoader(THREE.TextureLoader, rocks)\r\n  const dM = useLoader(THREE.TextureLoader, rocksDisp)\r\n\r\n  // texture.wrapS = texture.wrapT = THREE.RepeatWrapping\r\n  // texture.repeat.set(10, 10)\r\n\r\n  // dM.wrapS = texture.wrapT = THREE.RepeatWrapping\r\n  // dM.repeat.set(10, 10)\r\n\r\n  const material = useRef(\r\n    new THREE.MeshPhongMaterial({\r\n      color: 'grey',\r\n      side: THREE.DoubleSide,\r\n      map:texture,\r\n      displacementMap: dM,\r\n      wireframe: wireframe,\r\n    })\r\n  )\r\n\r\n  // const [ref, api] = useConvexPolyhedron(() => ({\r\n  //   mass: 0,\r\n  //   type: 'Static',\r\n  //   rotation: [Math.PI / 2, 0, Math.PI / 2],\r\n  //   position: [0, 0, 0],\r\n  //   args: geometry.current,\r\n  // }))\r\n\r\n  useEffect(() => {\r\n    geometry.current = new THREE.PlaneGeometry(\r\n      mapSize,\r\n      mapSize,\r\n      vertices,\r\n      vertices\r\n    )\r\n\r\n    const mV = modifiedVertices(\r\n      geometry.current,\r\n      amp,\r\n      length,\r\n      canyons,\r\n      xShift,\r\n      yShift\r\n    )\r\n    //set visible plane\r\n    geometry.current.vertices = mV\r\n    //set CVPH hitbox\r\n    // ref.current.geometry.vertices = mV\r\n  }, [canyons, wireframe, mapSize, amp, vertices, length, xShift, yShift])\r\n  //canyons, wireframe, mapSize, amp, vertices, length, xShift, yShift\r\n\r\n  return (\r\n    <>\r\n      <mesh\r\n        args={[geometry.current, material.current]}\r\n        castShadow\r\n        receiveShadow\r\n        {...props}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nexport const Terrain = () => {\r\n  return (\r\n    <>\r\n      <Plane rotation={[Math.PI / 2, 0, Math.PI / 2]} />\r\n      <Water />\r\n    </>\r\n  )\r\n}\r\n","import { useEffect, useRef, forwardRef } from 'react'\r\nimport * as THREE from 'three'\r\nimport { useFrame } from 'react-three-fiber'\r\n\r\nexport const PlayerMovement = forwardRef((props, ref) => {\r\n  const STATS = props.STATS\r\n  const api = props.api\r\n  const {forward, backward, left, right, jump, run} = props.C\r\n\r\n  const velocity = useRef([0, 0, 0])\r\n  const position = useRef([0, 0, 0])\r\n\r\n  //no continuous jumping\r\n  const jumpCoolDown = useRef()\r\n\r\n  const direction = new THREE.Vector3()\r\n  const frontVector = new THREE.Vector3()\r\n  const sideVector = new THREE.Vector3()\r\n\r\n  const camEuler = new THREE.Euler()\r\n\r\n  const playerOnGround = () => {\r\n    return position.current[1] < 1\r\n  }\r\n  // const playerOnGround = () => {\r\n  //   return true\r\n  // }\r\n\r\n  const applyFriction = () => {\r\n    velocity.current[0] -= velocity.current[0] / STATS.inertia\r\n    velocity.current[2] -= velocity.current[2] / STATS.inertia\r\n  }\r\n\r\n  const calculateVelocity = () => {\r\n    frontVector.set(0, 0, backward - forward)\r\n    sideVector.set(left - right, 0, 0)\r\n    camEuler.set(0, 0, 0)\r\n\r\n    let FinalSpeed = STATS.speed\r\n\r\n    if (left || right) {\r\n      FinalSpeed = STATS.pan_speed()\r\n    } else if (run) {\r\n      FinalSpeed = STATS.run_speed()\r\n    }\r\n\r\n    direction\r\n      .subVectors(frontVector, sideVector)\r\n      .normalize()\r\n      .multiplyScalar(FinalSpeed)\r\n      .applyEuler(props.camera.rotation)\r\n\r\n    applyFriction()\r\n\r\n    const v = [\r\n      velocity.current[0] + direction.x / STATS.inertia,\r\n      velocity.current[1],\r\n      velocity.current[2] + direction.z / STATS.inertia,\r\n    ]\r\n\r\n    if (playerOnGround()) {\r\n      api.velocity.set(v[0], v[1], v[2])\r\n\r\n      if (!jump) jumpCoolDown.current = false\r\n      if (jump && !jumpCoolDown.current) {\r\n        jumpCoolDown.current = true\r\n        api.velocity.set(v[0], STATS.jump_height(), v[2])\r\n      }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    api.velocity.subscribe(v => (velocity.current = v))\r\n    api.position.subscribe(v => (position.current = v))\r\n  }, [])\r\n\r\n  useFrame(() => {\r\n    calculateVelocity()\r\n  })\r\n\r\n  return null\r\n})\r\n","import React from 'react'\r\n\r\nimport { PointerLockControls } from '@react-three/drei'\r\nimport { forwardRef } from 'react'\r\nimport { useFrame } from 'react-three-fiber'\r\n\r\nexport const PlayerCamera = forwardRef((props, ref) => {\r\n  function moveCamera() {\r\n    const pos = ref.current.position\r\n\r\n    props.camera.position.y = pos.y + props.STATS.player_height\r\n\r\n    props.camera.position.x = pos.x\r\n\r\n    props.camera.position.z = pos.z\r\n  }\r\n\r\n  useFrame(() => {\r\n    moveCamera()\r\n  })\r\n\r\n  return <PointerLockControls/>\r\n})\r\n","export default __webpack_public_path__ + \"static/media/ball.f2754941.jpg\";","import React from 'react'\r\nimport * as THREE from 'three'\r\nimport { useThree, useLoader } from 'react-three-fiber'\r\nimport { useSphere } from 'use-cannon'\r\n\r\nimport { PlayerMovement } from './PlayerMovement'\r\nimport { PlayerCamera } from './PlayerCamera'\r\nimport { usePlayerControls } from './PlayerControls'\r\n\r\nimport ball from './ball.jpg'\r\n\r\nexport default function Player(props) {\r\n  const STATS = {\r\n    speed: 5,\r\n    player_height: 2.5,\r\n    run_speed: () => STATS.speed * 2,\r\n    pan_speed: () => STATS.speed * 0.6,\r\n    jump_height: () => STATS.player_height * 3,\r\n    inertia: 5,\r\n  }\r\n\r\n  // Player hitbox\r\n  const [ref, api] = useSphere(() => ({\r\n    mass: 1,\r\n    type: 'Dynamic',\r\n    position: [0, STATS.player_height, 0],\r\n    size: [1, 32, 32],\r\n    ...props,\r\n  }))\r\n\r\n  const { camera } = useThree()\r\n  const { forward, backward, left, right, jump, run } = usePlayerControls()\r\n\r\n  const texture = useLoader(THREE.TextureLoader, ball)\r\n\r\n  return (\r\n    <group>\r\n      <PlayerCamera ref={ref} STATS={STATS} camera={camera} />\r\n      <PlayerMovement\r\n        ref={ref}\r\n        api={api}\r\n        STATS={STATS}\r\n        camera={camera}\r\n        C={{ forward, backward, left, right, jump, run }}\r\n      />\r\n      <mesh ref={ref} castShadow receiveShadow>\r\n        <sphereBufferGeometry attach=\"geometry\" args={[1, 32, 32]} />\r\n        <meshStandardMaterial attach=\"material\" map={texture} />\r\n      </mesh>\r\n    </group>\r\n  )\r\n}\r\n","import { useState, useEffect } from 'react'\r\n\r\nexport const usePlayerControls = () => {\r\n  const [movement, setMovement] = useState({\r\n    forward: false,\r\n    backward: false,\r\n    left: false,\r\n    right: false,\r\n    jump: false,\r\n    run: false,\r\n  })\r\n\r\n  const keys = {\r\n    KeyW: 'forward',\r\n    KeyS: 'backward',\r\n    KeyA: 'left',\r\n    KeyD: 'right',\r\n    Space: 'jump',\r\n    ShiftLeft: 'run',\r\n  }\r\n\r\n  const moveFieldByKey = key => keys[key]\r\n\r\n  useEffect(() => {\r\n    const handleKeyDown = e =>\r\n      setMovement(m => ({ ...m, [moveFieldByKey(e.code)]: true }))\r\n\r\n    const handleKeyUp = e =>\r\n      setMovement(m => ({ ...m, [moveFieldByKey(e.code)]: false }))\r\n\r\n    document.addEventListener('keydown', handleKeyDown)\r\n    document.addEventListener('keyup', handleKeyUp)\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown)\r\n      document.removeEventListener('keyup', handleKeyUp)\r\n    }\r\n  }, [])\r\n  return movement\r\n}\r\n","import React from 'react'\r\nimport { Controls } from 'react-three-gui'\r\n// import { OrbitControls, softShadows } from '@react-three/drei'\r\n\r\nimport { Lighting } from './lighting/Lighting'\r\nimport { Terrain } from './terrain/Terrain'\r\nimport Player from './player/Player'\r\nimport { Physics } from 'use-cannon'\r\n\r\nimport './App.css'\r\n\r\n// <Canvas>\r\n// shadowMap\r\n// gl={{ alpha: false }}\r\n// camera={{ position: [30, 20, 30], fov: 90 }}\r\n\r\nexport default function App() {\r\n  return (\r\n    <Controls.Provider>\r\n      <Controls.Canvas shadowMap gl={{ antialias: false, alpha: false }}>\r\n        <Lighting />\r\n        <Physics>\r\n          <Player />\r\n          <Terrain />\r\n        </Physics>\r\n      </Controls.Canvas>\r\n      <Controls />\r\n    </Controls.Provider>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport App from './App'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n"],"sourceRoot":""}