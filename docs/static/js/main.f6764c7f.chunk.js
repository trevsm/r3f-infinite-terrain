(this["webpackJsonpr3f-infinite-terrain"]=this["webpackJsonpr3f-infinite-terrain"]||[]).push([[0],{248:function(e,t,r){},249:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),c=r(60),i=r.n(c),o=r(22),u=r(5),m=r(255),s=function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement(m.a,{distance:45e4,sunPosition:[150,150,150],inclination:0,azimuth:.25}),n.a.createElement("ambientLight",null),n.a.createElement("directionalLight",{position:[150,150,150],"shadow-camera-left":-1e3,"shadow-camera-bottom":-1e3,"shadow-camera-right":1e3,"shadow-camera-top":1e3,"shadow-camera-near":.1,"shadow-camera-far":1500,castShadow:!0}))},l=r(20),d=r.p+"static/media/rock.2a68dd7c.jpg",p=r.p+"static/media/DisplacementMap.876a1148.png",f=r.p+"static/media/grass.75f6dd80.png";function h(e){var t=e.geometry,r=[];t.vertices.forEach((function(e){e.z<-.5&&5*Math.random()<3&&(r.push(e.x+Math.random()/3),r.push(e.y+Math.random()/3),r.push(e.z+Math.random()/3))}));var c=Object(a.useMemo)((function(){return new Float32Array(r)}),[r]),i=Object(a.useRef)(),o=Object(l.c)(u.TextureLoader,f);return n.a.createElement(n.a.Fragment,null,n.a.createElement("points",{ref:i},n.a.createElement("bufferGeometry",{attach:"geometry"},n.a.createElement("bufferAttribute",{attachObject:["attributes","position"],count:c.length/3,array:c,itemSize:3})),n.a.createElement("pointsMaterial",{map:o,size:2,transparent:!0,opacity:1,sizeAttenuation:!0,depthWrite:!1,side:u.DoubleSide})))}var b={rand_vect:function(){var e=2*Math.random()*Math.PI;return{x:Math.cos(e),y:Math.sin(e)}},dot_prod_grid:function(e,t,r,a){var n,c=e-r,i=t-a;return this.gradients[[r,a]]?n=this.gradients[[r,a]]:(n=this.rand_vect(),this.gradients[[r,a]]=n),c*n.x+i*n.y},smootherstep:function(e){return 6*Math.pow(e,5)-15*Math.pow(e,4)+10*Math.pow(e,3)},interp:function(e,t,r){return t+this.smootherstep(e)*(r-t)},seed:function(){this.gradients={}},memory:{},get:function(e,t){if(this.memory.hasOwnProperty([e,t]))return this.memory[[e,t]];var r=Math.floor(e),a=Math.floor(t),n=this.dot_prod_grid(e,t,r,a),c=this.dot_prod_grid(e,t,r+1,a),i=this.dot_prod_grid(e,t,r,a+1),o=this.dot_prod_grid(e,t,r+1,a+1),u=this.interp(e-r,n,c),m=this.interp(e-r,i,o),s=this.interp(t-a,u,m);return this.memory[[e,t]]=s,s}};b.seed();var y=r(11),j=r(250);function g(){var e=Object(o.b)("Water Level",{type:"number",value:0,min:-5,max:5}),t=Object(j.e)((function(){return{position:[0,e,0],rotation:[-Math.PI/2,0,0],args:[1e3,1e3,64,64]}})),r=Object(y.a)(t,2),a=r[0];r[1];return Object(l.b)((function(){a.current.position.y=e})),n.a.createElement("mesh",{ref:a,receiveShadow:!0},n.a.createElement("planeBufferGeometry",{attach:"geometry",args:[1e3,1e3,64,64]}),n.a.createElement("meshStandardMaterial",{attach:"material",side:u.DoubleSide,metalness:2,color:"blue",transparent:!0,opacity:.2}))}var v=function(e){var t=Object(o.b)("Canyons",{type:"boolean",value:!1}),r=Object(o.b)("Wireframe",{type:"boolean",value:!1}),c=Object(o.b)("Map Size",{type:"number",value:100,min:10,max:1e3}),i=Object(o.b)("Vertices",{type:"number",value:300,min:10,max:1e3}),m=Object(o.b)("Amplitude",{type:"number",value:30,min:0,max:50}),s=Object(o.b)("Length",{type:"number",value:.03,min:0,max:.1}),f=Object(o.b)("X-Shift",{type:"number",value:0,min:-5,max:5}),y=Object(o.b)("Y-Shift",{type:"number",value:0,min:-5,max:5}),j=Object(a.useRef)(new u.PlaneGeometry(c,c,i,i)),g=Object(l.c)(u.TextureLoader,d),v=Object(l.c)(u.TextureLoader,p),O=Object(a.useRef)(new u.MeshPhongMaterial({color:"grey",side:u.DoubleSide,map:g,displacementMap:v,wireframe:r})),E=Object(a.useRef)();return Object(a.useEffect)((function(){j.current=new u.PlaneGeometry(c,c,i,i);var e=function(e,t,r,a,n,c){return e.vertices.map((function(e){var i=t*b.get(r*e.x+n,r*e.y+c);return a&&(i+=Math.floor(i)),new u.Vector3(e.x,e.y,i)}))}(j.current,m,s,t,f,y);j.current.vertices=e,E.current=n.a.createElement(h,{geometry:j.current})}),[t,r,c,m,i,s,f,y]),n.a.createElement(n.a.Fragment,null,n.a.createElement("group",{rotation:[Math.PI/2,0,Math.PI/2]},E.current),n.a.createElement("mesh",Object.assign({args:[j.current,O.current],castShadow:!0,receiveShadow:!0},e)))},O=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(v,{rotation:[Math.PI/2,0,Math.PI/2]}),n.a.createElement(g,null))},E=r(38),w=Object(a.forwardRef)((function(e,t){var r=e.STATS,n=e.api,c=e.C,i=c.forward,o=c.backward,m=c.left,s=c.right,d=c.jump,p=c.run,f=Object(a.useRef)([0,0,0]),h=Object(a.useRef)([0,0,0]),b=Object(a.useRef)(),y=new u.Vector3,j=new u.Vector3,g=new u.Vector3,v=new u.Euler,O=function(){j.set(0,0,o-i),g.set(m-s,0,0),v.set(0,0,0);var t=r.speed;m||s?t=r.pan_speed():p&&(t=r.run_speed()),y.subVectors(j,g).normalize().multiplyScalar(t).applyEuler(e.camera.rotation),f.current[0]-=f.current[0]/r.inertia,f.current[2]-=f.current[2]/r.inertia;var a=[f.current[0]+y.x/r.inertia,f.current[1],f.current[2]+y.z/r.inertia];h.current[1]<1&&(n.velocity.set(a[0],a[1],a[2]),d||(b.current=!1),d&&!b.current&&(b.current=!0,n.velocity.set(a[0],r.jump_height(),a[2])))};return Object(a.useEffect)((function(){n.velocity.subscribe((function(e){return f.current=e})),n.position.subscribe((function(e){return h.current=e}))}),[]),Object(l.b)((function(){O()})),null})),M=r(254),S=Object(a.forwardRef)((function(e,t){return Object(l.b)((function(){!function(){var r=t.current.position;e.camera.position.y=r.y+e.STATS.player_height,e.camera.position.x=r.x,e.camera.position.z=r.z}()})),n.a.createElement(M.a,null)})),_=r(12),x=r.p+"static/media/ball.f2754941.jpg";function L(e){var t={speed:5,player_height:2.5,run_speed:function(){return 2*t.speed},pan_speed:function(){return.6*t.speed},jump_height:function(){return 3*t.player_height},inertia:5},r=Object(j.d)((function(){return Object(E.a)({mass:1,type:"Dynamic",position:[0,t.player_height,0],size:[1,32,32]},e)})),c=Object(y.a)(r,2),i=c[0],o=c[1],m=Object(l.d)().camera,s=function(){var e=Object(a.useState)({forward:!1,backward:!1,left:!1,right:!1,jump:!1,run:!1}),t=Object(y.a)(e,2),r=t[0],n=t[1],c={KeyW:"forward",KeyS:"backward",KeyA:"left",KeyD:"right",Space:"jump",ShiftLeft:"run"},i=function(e){return c[e]};return Object(a.useEffect)((function(){var e=function(e){return n((function(t){return Object(E.a)(Object(E.a)({},t),{},Object(_.a)({},i(e.code),!0))}))},t=function(e){return n((function(t){return Object(E.a)(Object(E.a)({},t),{},Object(_.a)({},i(e.code),!1))}))};return document.addEventListener("keydown",e),document.addEventListener("keyup",t),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}}),[]),r}(),d=s.forward,p=s.backward,f=s.left,h=s.right,b=s.jump,g=s.run,v=Object(l.c)(u.TextureLoader,x);return n.a.createElement("group",null,n.a.createElement(S,{ref:i,STATS:t,camera:m}),n.a.createElement(w,{ref:i,api:o,STATS:t,camera:m,C:{forward:d,backward:p,left:f,right:h,jump:b,run:g}}),n.a.createElement("mesh",{ref:i,castShadow:!0,receiveShadow:!0},n.a.createElement("sphereBufferGeometry",{attach:"geometry",args:[1,32,32]}),n.a.createElement("meshStandardMaterial",{attach:"material",map:v})))}r(248);function k(){return n.a.createElement(o.a.Provider,null,n.a.createElement(o.a.Canvas,{shadowMap:!0,gl:{antialias:!1,alpha:!1}},n.a.createElement(s,null),n.a.createElement(j.a,null,n.a.createElement(L,null),n.a.createElement(O,null))),n.a.createElement(o.a,null))}i.a.render(n.a.createElement(k,null),document.getElementById("root"))}},[[249,1,2]]]);
//# sourceMappingURL=main.f6764c7f.chunk.js.map